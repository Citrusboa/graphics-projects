<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
	<title>CS 488/688: Introduction to Computer Graphics</title>

	<!-- Bootstrap -->
	<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

	<!-- Custom styles for this template -->
	<link href="bootstrap/css/carousel.css" rel="stylesheet">

	<style>
		/* Customize container */
		@media (min-width: 800px) {
			.container {
				max-width: 800px;
			}
		}
		.container-narrow > hr {
			margin: 30px 0px;
		}
		dd {
			padding-bottom: 10px;
			padding-left: 10px;
		}
		dl {
			padding-bottom: 0px;
		}
	</style>
</head>


<body role="document">


<body role="document">
	<div class="container" role="main">
	<center>
		<h2>CS 488/688: Introduction to Computer Graphics</h2>
		<h4>Assignment 1: Rasterization</h4><hr>
	</center>


	<h3>Summary</h3>

	<p>
	In this assignment, you will implement rasterization. Modern GPUs implement rasterization in hardware, and 3D graphics APIs such as OpenGL and DirectX abstract away the details behind it. You will implement a simplified rasterization process <em>in software</em>, meaning that you do 3D graphics without a GPU! Completing this assignment lets you understand the common core ideas used by virtually all graphics APIs for interactive rendering. There are multiple tasks, as described below.
	</p>
	
	<div class="alert alert-info" role="alert">
	Before you start, try reading through <code>cs488.h</code>, except for the part that says, "you do not need to modify it". In particular, focus on those parts that refer to "A1" and see how those parts are related and called from each other. You will fill in those missing parts in <code>cs488.h</code> throughout the assignments.
	</div>
	
	<div class="alert alert-warning" role="alert">
	Do NOT replace software rasterization with hardware rasterization on GPUs by calling OpenGL APIs (or any other 3D graphics APIs) and call this assignment done. You will get zero points for doing so. You will NOT need to learn OpenGL or any other APIs in this course. You will instead learn fundamental technical ideas behind them.
	</div>


	<h3>Task 0: main.cpp</h3>
	<p>
	Comment out <code>A0(argc, argv)</code> and comment in <code>A1(argc, argv)</code> to enable a simple setup code in <code>main.cpp</code>. The default code is trying to load .obj file in the command line arguments as in <code>cs488.exe cube.obj</code>, or it will create a single triangle otherwise. There is one point light source added as well (but it does not matter in this assignment for now). You do not need to prepare or load .obj file at this point. If the code runs, you just see a window that shows nothing. No, it is not a bug. You will code it to show something interesting.
	</p>
	<center>
		<img style="max-width : 75%" src="a1_res/t0.png"/>
	</center>


	<h3>Task 1: Perspective transformation matrix</h3>
	<p>
	Your first task is to set up a proper matrix for perspective transformation. Look up <code>void Rasterize()</code> in the <code>Scene</code> class and check out a matrix <code>float4x4 plm</code> there. You need to fill in <code>plm</code> as a matrix that transforms a vertex in the world space (the base code stores all the vertices in the world space) to the clip space (the space where you can perform clipping). Just above <code>Rasterize()</code>, you will see two functions <code>perspectiveMatrix</code> and <code>lookatMatrix</code> that you will need to use by taking into account the current camera parameters. You can find variables for the camera parameters at the beginning of <code>cs488.h</code>. After finishing this task, you will still see the same window.
	</p>


	<h3>Task 2: Rasterize points</h3>
	<p>
	After you have a proper matrix set up (or at least you believe it is), then you now look up <code>void rasterizeTriangle</code> in the <code>TriangleMesh</code> class. The function <code>rasterizeTriangle</code> takes the <code>plm</code> matrix from above and also takes a triangle in the world space. You can access each vertex in the triangle via <code>tri.positions[0]</code>, for example (there are three vertices in a triangle, right?). Figure out how to compute the index <code>i, j</code> of each point and then fill in the pixel by <code>FrameBuffer.pixel(i, j) = float3(1.0f)</code>. You basically rasterize the points (vertices) of each triangle. You will see something like this (look for three white pixels):
	</p>
	<center>
		<img style="max-width : 75%" src="a1_res/t2.png"/>
	</center>
	<br>
	<p>
	Congratulations! You can move around this 3D triangle by dragging via the left mouse button and pressing WASDQZ keys (like a first-person shooter). You may now want to try loading some example .obj files. Here is a result of cornellbox.obj.
	</p>
	<center>
		<img style="max-width : 75%" src="a1_res/t2a.png"/>
	</center>
	<p>
	<div class="alert alert-warning" role="alert">
		You should check if <code>i, j</code> is in the image. You can do so by calling <code>FrameBuffer.valid(i, j)</code>. 
	</div>
	</p>


	<h3>Task 3: Rasterize triangles</h3>
	<p>
	Now you take those points and fill in the inside of a triangle. The lecture should have covered how to do it, but basically, you will need to loop over pixels in <code>FrameBuffer</code> and fill in those pixels inside the triangle. At this stage, filling in those pixels with a proper colour assigned for each triangle would be interesting. You can access it via the float3 variable <code>materials[tri.idMaterial].Kd</code>. You will see an image like this for the single default triangle. 
	<center>
		<img style="max-width : 75%" src="a1_res/t3.png"/>
	</center>
	</p>
	<div class="alert alert-info" role="alert">
		Starting from here, you might experience that your program is "less interactive". You will particularly experience this if you are building your program in a "debug" mode since some compiler optimizations are generally turned off in this mode. They are pretty important for graphics programs to run efficiently. Consider enabling some optimizations back in a debug mode or running in a "release" mode if you want to load a complex .obj file. This advice applies to the other assignments. Test or debug for simple examples and switch to a release build for something more complex.
	</div>



	<h3>Task 4: Depth buffering</h3>
	<p>
	If you load cornellbox.obj at this point, you will see something like this:
	<center>
		<img style="max-width : 75%" src="a1_res/t4.png"/>
	</center><br>
	Is that correct? Actually not. This .obj file is supposed to be looking like this instead:<br><br>
	<center>
		<img style="max-width : 75%" src="a1_res/t4c.png"/>
	</center><br>
	What's wrong? It is because you have not implemented depth buffering. You can access the depth buffer via <code>FrameBuffer.depth(i, j)</code> which is already initialized for you in each frame. Use this depth buffer to figure out how to perform correct z-buffering. You need to compute a proper depth by interpolating a transformed z value at each vertex. If it is working, you will see the above image.
	</p>



	<h3>Task 5: Perspective correct interpolation</h3>
	<p>
	For this task, you need to call <code>static float3 shade</code> to fill in the pixel value to fetch a texture. To do so, you need to fill in the member variables of the <code>HitInfo</code> class. For this assignment, you need to fill in <code>T</code>, which stores a texture coordinate. Your task is to interpolate to fill in <code>T</code> and then call the shade function. Note that <code>material</code> pointer can be filled in as <code>material = &materials[tri.idMaterial]</code>. You can access the texture coordinate at each vertex as <code>tri.texcoords[0]</code> which is <code>float2</code>. You need to interpolate those via perspective-correct interpolation.
	
	If you load textured.obj with (perspective) incorrect interpolation, you will see something like this:
	<center>
		<img style="max-width : 75%" src="a1_res/t5w.png"/>
	</center><br>
	The correct rendering with perspective correct interpolation will look like this: <br><br>
	<center>
		<img style="max-width : 75%" src="a1_res/t5c.png"/>
	</center><br>



	<h3>Extras</h3>
	<p>
	All of the assignments come with optional extra tasks for those of you who would like more challenges and potentially gain extra points! Specification of an extra task is intentionally very-high level. Explain what you did in README if you want an extra point. You may or may not receive an extra point depending on our evaluation.
	</p>
	
	<h3>Extra 1: Faster rasterization</h3>
	<p>
	The basic rasterization algorithm explained in the lecture is working, but not the fastest possible. Make your rasterization faster. Report the performance boost. We expect you to do something algorithmic, not just change compiler options or minor coding optimization. You can also do any optimization, except for using other libraries or APIs. Make your rasterizer as fast as possible!
	</p>
	
	<h3>Extra 2: Proper clipping</h3>
	<p>
	You are not required to implement proper clipping in this assignment. However, implementing clipping would be helpful if you expect a triangle to intersect with the near plane. Implement proper clipping and demonstrate the difference.
	</p>




	<h3>What to submit</h3>
	<p>
	The submission process for this assignment is basically the same as the one for Assignment 0. Prepare a ZIP file of your code, omitting unnecessary files (executables, build files, etc.). Upload the ZIP file to LEARN.
	</p>
	<p>As with Assignment 0, you <em>must</em> submit the <code>README</code>. In this assignment, you need to provide multiple screenshots to demonstrate what you achieved in each task. Name them as <code>screenshotTask2.png</code> etc., to clarify which task you are referring to. If you omit either of the files, you will receive a deduction. See <a href="a0.html">Assignment 0</a> for instructions about how to prepare these files. 
	</p>
	<p>
	If you do extend the base code, be sure to document your extensions in your <code>README</code> file. Keep in mind that
	you must still satisfy the core objectives listed here. If your changes are so radical that your modified program is 
	incompatible with the original specification, you must include a "compatibility mode" that makes the interface behave like the requirements here, or consider creating an entirely separate project (but hey, is that making sense?).
	</p>
	
<div class="alert alert-info" role="alert">
While you can use them as your references, you are not required to render the same images as in this page (but you still should be able to if you are asked). You may choose different .obj files to demonstrate your results. Be creative!
</div>

	<h3>Other thoughts</h3>
	<p>
	After completing this assignment, you will have your basic rasterizer ready for some interesting interactive applications. Think about how you might want to extend or any additional rasterization techniques you might want to implement on top of it. Those are great candidates for your final project; maybe you can rocket-start already to work on some of them!
	</p>

	<h3>Objectives</h3>
	<p>
	Every assignment includes a list of objectives. Your mark in the assignment will be based primarily on the achievement of these objectives, with possible deductions outside the list if necessary.
	</p>

	<ol>
		<li>
		A correct matrix for perspective transformation is computed.
		</li>
		<li>
		Vertices of triangles are properly rasterized.
		</li>
		<li>
		Triangles are properly rasterized.
		</li>
		<li>
		Depth buffering is working correctly.
		</li>
		<li>
		Perspective correct interpolation is done.
		</li>
	</ol>

	</div>

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<!-- Include all compiled plugins (below), or include individual files as needed -->
	<script src="bootstrap/js/bootstrap.min.js"></script>
	</body>
</html>
